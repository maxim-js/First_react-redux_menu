{"ast":null,"code":"import _objectSpread from \"/Users/macbook/Documents/programming/JS_task_answers-master/React_step_14/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\n// параметр по умолчанию\nconst initialState = {\n  menu: [],\n  loading: true,\n  error: false,\n  items: [],\n  totalPrice: 0\n};\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case 'MENU_LOADED':\n      return _objectSpread({}, state, {\n        menu: action.payload,\n        loading: false,\n        error: false\n      });\n\n    case 'MENU_REQUESTED':\n      return _objectSpread({}, state, {\n        menu: state.menu,\n        loading: true,\n        error: false\n      });\n\n    case 'MENU_ERROR':\n      return _objectSpread({}, state, {\n        menu: state.menu,\n        error: true\n      });\n\n    case 'ITEM_ADD_TO_CART':\n      const id = action.payload;\n      const itemInd = state.items.findIndex(item => item.id === id);\n\n      if (itemInd >= 0) {\n        const itemInState = state.items.find(item => item.id === id);\n\n        const newItem = _objectSpread({}, itemInState, {\n          qtty: ++itemInState.qtty\n        });\n\n        return _objectSpread({}, state, {\n          items: [...state.items.slice(0, itemInd), newItem, ...state.items.slice(itemInd + 1)],\n          totalPrice: state.totalPrice + newItem.price\n        });\n      } // товара раньше не было в корзине\n\n\n      const item = state.menu.find(item => item.id === id);\n      const newItem = {\n        title: item.title,\n        price: item.price,\n        url: item.url,\n        id: item.id,\n        qtty: 1\n      };\n      return _objectSpread({}, state, {\n        items: [...state.items, newItem],\n        totalPrice: state.totalPrice + newItem.price\n      });\n\n    case 'ITEM_REMOVE_FROM_CART':\n      const idx = action.payload;\n      const itemIndex = state.items.findIndex(item => item.id === idx);\n      const price = state.items[itemIndex]['price'] * state.items[itemIndex]['qtty'];\n      return _objectSpread({}, state, {\n        items: [...state.items.slice(0, itemIndex), ...state.items.slice(itemIndex + 1)],\n        totalPrice: state.totalPrice - price\n      });\n\n    default:\n      return state;\n  }\n};\n\nexport default reducer;","map":{"version":3,"sources":["/Users/macbook/Documents/programming/JS_task_answers-master/React_step_14/src/reducers/index.js"],"names":["initialState","menu","loading","error","items","totalPrice","reducer","state","action","type","payload","id","itemInd","findIndex","item","itemInState","find","newItem","qtty","slice","price","title","url","idx","itemIndex"],"mappings":"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","sourcesContent":["// параметр по умолчанию\nconst initialState = {\n    menu: [],\n    loading: true,\n    error: false,\n    items: [],\n    totalPrice: 0\n}\n\n\nconst reducer = (state = initialState, action) => {\n    switch (action.type) {\n        case 'MENU_LOADED':\n            return {\n                ...state,\n                menu: action.payload,\n                loading: false,\n                error: false\n            };\n        case 'MENU_REQUESTED':\n            return {\n                ...state,\n                menu: state.menu,\n                loading: true,\n                error: false\n            };\n        case 'MENU_ERROR':\n            return {\n                ...state,\n                menu: state.menu,\n                error: true\n            };\n        case 'ITEM_ADD_TO_CART':\n            const id = action.payload;\n            \n            const itemInd = state.items.findIndex(item => item.id === id);\n            if (itemInd >= 0){\n                const itemInState = state.items.find(item => item.id === id);\n                const newItem = {\n                    ...itemInState,\n                    qtty: ++itemInState.qtty\n                }\n                return {\n                    ...state, \n                    items: [\n                        ...state.items.slice(0, itemInd),\n                        newItem,\n                        ...state.items.slice(itemInd + 1)\n                    ],\n                    totalPrice: state.totalPrice + newItem.price\n                }\n\n            } \n            // товара раньше не было в корзине\n            const item = state.menu.find(item => item.id === id);\n            const newItem = {\n                title: item.title,\n                price: item.price,\n                url: item.url,\n                id: item.id,\n                qtty: 1\n            };\n            \n            return {\n                ...state,\n                items: [\n                    ...state.items,\n                    newItem\n                ],\n                totalPrice: state.totalPrice + newItem.price\n            };\n\n        case 'ITEM_REMOVE_FROM_CART':\n            const idx = action.payload;\n            const itemIndex = state.items.findIndex(item => item.id === idx)\n            const price = state.items[itemIndex]['price'] * state.items[itemIndex]['qtty'];\n            return {\n                ...state, \n                items: [\n                    ...state.items.slice(0, itemIndex),\n                    ...state.items.slice(itemIndex + 1)\n                ], \n                totalPrice: state.totalPrice - price\n            }\n        default: \n            return state;\n    }\n}\n\nexport default reducer;"]},"metadata":{},"sourceType":"module"}